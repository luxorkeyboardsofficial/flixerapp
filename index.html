<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flixer PWA</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <script>
        let deferredPrompt;

        // Listen for the beforeinstallprompt event
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the default browser prompt
            e.preventDefault();
            // Store the event for later use
            deferredPrompt = e;
            // Show the custom install button
            const installButton = document.getElementById('installButton');
            if (installButton) {
                installButton.style.display = 'block';
            }
        });

        // Register the Service Worker on page load
        window.addEventListener('load', () => {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('Service Worker registered', reg))
                    .catch(err => console.log('Service Worker registration failed', err));
            }
        });

        // Function to trigger the install prompt
        function showInstallPrompt() {
            if (deferredPrompt) {
                // Show the browser's install prompt
                deferredPrompt.prompt();
                // Check the user's choice
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    } else {
                        console.log('User dismissed the install prompt');
                    }
                    // Reset the deferredPrompt
                    deferredPrompt = null;
                });
            }
        }
    </script>
</head>
<body>
    <div class="iframe-container">
        <iframe src="https://flixer.su/" frameborder="0"></iframe>
    </div>
    <button id="installButton" onclick="showInstallPrompt()" style="display: none; position: fixed; top: 10px; right: 10px; z-index: 1000;">
        Install App
    </button>
</body>
</html>
